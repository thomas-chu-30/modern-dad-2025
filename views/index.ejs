<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>èªéŸ³æ§åˆ¶ç¯„ä¾‹</title>
    <!-- Tailwind CSS CDN -->
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <style>
      .language-switch {
        margin: 10px 0;
      }
      .language-btn {
        padding: 5px 10px;
        margin: 0 5px;
        cursor: pointer;
      }
      .language-btn.active {
        background-color: #4caf50;
        color: white;
        border: none;
      }
    </style>
  </head>
  <body>
    <h1>è«‹èªªå‡ºä½ çš„æŒ‡ä»¤</h1>
    <p>ä¾‹å¦‚ï¼šã€Œæ‰“é–‹ YouTubeã€ã€ã€Œæ‰“é–‹ Googleã€ã€ã€Œæ‰“é–‹ Facebookã€</p>
    <div class="language-switch mt-4">
      <button class="language-btn active" onclick="switchLanguage('zh-TW')">ä¸­æ–‡</button>
      <button class="language-btn" onclick="switchLanguage('en-US')">English</button>
    </div>
    <button onclick="startListening()">ğŸ¤ é–‹å§‹è½</button>
    <p id="result"></p>

    <script src="/js/speech-recognition.js"></script>
    <script>
      // ä½¿ç”¨å·¥å» å»ºç«‹èªéŸ³è¾¨è­˜æœå‹™
      const speechService = SpeechRecognitionFactory.createService("web");

      // è¨­å®šçµæœå›èª¿
      speechService.onResult((transcript, language) => {
        console.log("transcript", transcript, "language", language);
        document.getElementById("result").innerText = `è¾¨è­˜çµæœ: ${transcript}`;
        handleCommand(transcript, language);
      });

      // è¨­å®šéŒ¯èª¤å›èª¿
      // ç•¶èªéŸ³è¾¨è­˜éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œæœƒè§¸ç™¼æ­¤å›èª¿å‡½æ•¸
      // ä¾‹å¦‚ï¼šç„¡æ³•å­˜å–éº¥å…‹é¢¨ã€èªéŸ³è¾¨è­˜æœå‹™ä¸å¯ç”¨ã€ç¶²è·¯å•é¡Œç­‰
      speechService.onError((event) => {
        console.error("è¾¨è­˜éŒ¯èª¤", event);
      });

      function startListening() {
        speechService.start();
      }

      function switchLanguage(lang) {
        speechService.setLanguage(lang);
        // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll(".language-btn").forEach((btn) => {
          btn.classList.remove("active");
          if (btn.textContent.toLowerCase() === (lang === "zh-TW" ? "ä¸­æ–‡" : "english")) {
            btn.classList.add("active");
          }
        });
      }

      function handleCommand(command, language) {
        console.log(command, language);
        // ä¸­æ–‡æŒ‡ä»¤
        if (language === "zh-TW") {
          if (command.includes("æ‰“é–‹YouTube")) {
            window.open("https://www.youtube.com", "_blank");
          } else if (command.includes("æ‰“é–‹Google")) {
            window.open("https://www.google.com", "_blank");
          } else {
            alert("ç„¡æ³•è¾¨è­˜æŒ‡ä»¤ï¼š" + command);
          }
        }
        // è‹±æ–‡æŒ‡ä»¤
        else if (language === "en-US") {
          if (command.toLowerCase().includes("open youtube")) {
            window.open("https://www.youtube.com", "_blank");
          } else if (command.toLowerCase().includes("open google")) {
            window.open("https://www.google.com", "_blank");
          } else {
            alert("Unknown command: " + command);
          }
        }
      }
    </script>
  </body>
</html>
